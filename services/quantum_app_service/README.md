# Quantum App Service

The Quantum App Service provides APIs for managing quantum applications in the Quantum Hub platform.

## Features

- **Quantum App Management**: Create, list, update, and delete quantum applications
- **Version Management**: Track and manage different versions of quantum applications
- **Package Upload**: Upload quantum application packages as zip files
- **Package Validation**: Validate quantum application packages
- **Manifest Parsing**: Parse quantum_manifest.json files

## API Endpoints

- `GET /quantum-apps` - List quantum apps (with optional user filter)
- `POST /quantum-apps` - Create new quantum app
- `GET /quantum-apps/{id}` - Get quantum app details with versions
- `PUT /quantum-apps/{id}` - Update quantum app
- `DELETE /quantum-apps/{id}` - Delete quantum app
- `GET /quantum-apps/{id}/versions` - List versions for a quantum app
- `GET /quantum-apps/{id}/versions/{version_id}` - Get version details
- `GET /quantum-apps/{id}/versions/{version_id}/download` - Download package file
- `POST /quantum-apps/upload` - Upload quantum app package

## Getting Started

### Prerequisites

- Python 3.10+
- PostgreSQL 14+
- Docker (optional)

### Running the Service

#### Using Docker

```bash
docker-compose up quantum_app_service
```

#### Standalone

```bash
cd services/quantum_app_service
uvicorn app.main:app --host 0.0.0.0 --port 8003 --reload
```

## Development

### Package Format

The service accepts zip files containing:

1. `quantum_manifest.json` - Manifest file with app metadata
2. One or more `.qasm` files - Quantum circuit files

### Database Schema

The service uses the following database tables:

- `quantum_app` - Stores quantum application metadata
- `app_version` - Stores version information for quantum applications

The database schema uses string types for enum values to ensure compatibility with PostgreSQL. The following fields use string values:

- `quantum_app.type`: String representing the application type (e.g., "algorithm", "circuit", "model", "tool", "agent", "library", "other")
- `quantum_app.visibility`: String representing the visibility level (e.g., "private", "public", "restricted")
- `quantum_app.license_type`: String representing the license type (e.g., "mit", "apache", "gpl", "proprietary")
- `app_version.sdk_used`: String representing the SDK used (e.g., "quantum_cli", "qiskit", "cirq", "braket", "other")
- `app_version.status`: String representing the version status (e.g., "draft", "published", "deprecated")

### Manifest Format

The `quantum_manifest.json` file can follow either of these formats:

#### Standard Format

```json
{
  "name": "Quantum Teleportation",
  "description": "A quantum teleportation application",
  "type": "circuit",
  "version_number": "1.0.0",
  "sdk_used": "qiskit",
  "visibility": "private",
  "preferred_platform": "IBM",
  "preferred_device_id": "ibmq_qasm_simulator",
  "number_of_qubits": 3,
  "qasm_files": ["teleportation.qasm"],
  "input_schema": {
    "type": "object",
    "properties": {
      "state": {
        "type": "string",
        "description": "State to teleport"
      }
    }
  },
  "output_schema": {
    "type": "object",
    "properties": {
      "result": {
        "type": "string",
        "description": "Teleported state"
      }
    }
  }
}
```

#### Quantum CLI SDK Format

```json
{
  "app_name": "one",
  "version": "2.0.0",
  "app_description": "Quantum application for one",
  "author": "Quantum CLI SDK User",
  "license": "mit",
  "format": "zip",
  "application_type": "circuit",
  "application_source_type": "openqasm",
  "application_source_file": "one.qasm",
  "input": {
    "format": "json",
    "parameters": {
      "shots": 1024,
      "simulator": "qiskit"
    }
  },
  "expected_output": {
    "format": "json",
    "example": {
      "counts": {
        "00": 512,
        "11": 512
      },
      "execution_time": 0.05
    }
  },
  "quantum_cli_sdk_version": "quantum_cli",
  "preferred_hardware": "simulator",
  "compatible_hardware": [
    "simulator",
    "qiskit",
    "cirq",
    "braket"
  ],
  "keywords": [
    "quantum",
    "circuit"
  ],
  "readme": "# one\n\nQuantum circuit project generated by quantum-cli-sdk."
}
```

### Important Notes

1. **Case Sensitivity**: All enum values in the manifest file should be lowercase (e.g., "circuit" instead of "CIRCUIT").

2. **String Values**: The service converts all enum values to lowercase strings before storing them in the database.

3. **Compatibility**: The service automatically detects and normalizes the format to ensure compatibility with both standard and Quantum CLI SDK styles.

4. **Upload Process**: When uploading a quantum app package, the service:
   - Extracts the zip file
   - Parses the quantum_manifest.json file
   - Normalizes the manifest data
   - Creates a new quantum app and version in the database
   - Stores the package file for future downloads
